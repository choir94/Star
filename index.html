<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Catch the Ethos Logo</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- preload assets -->
  <link rel="preload" as="image" href="https://raw.githubusercontent.com/choir94/Star/main/Ethos.png">
  <style>
    *{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;}
    body {background: linear-gradient(135deg,#0f1e3a,#1f3f8f); color:#fff; display:flex; flex-direction:column; align-items:center; min-height:100vh; padding:1rem;}
    h1 {margin:1rem 0; font-size:1.8rem; text-align:center; text-shadow:0 2px 8px rgba(0,0,0,0.6);}
    #game {
      position:relative;
      width:320px;
      height:480px;
      background:
        linear-gradient(rgba(0,0,0,0.45), rgba(0,0,0,0.45)),
        url("https://raw.githubusercontent.com/choir94/Star/main/Ethos.png") center/cover no-repeat;
      border:4px solid #5fa8ff;
      border-radius:12px;
      overflow:hidden;
      box-shadow:0 20px 40px -10px rgba(31,63,143,0.6);
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
    }
    #player {position:absolute; bottom:10px; left:50%; transform:translateX(-50%); width:60px; height:12px; background:#ffe066; border-radius:6px; box-shadow:0 0 10px rgba(255,224,102,0.6);}
    .falling {position:absolute; pointer-events:none; display:flex; flex-direction:column; align-items:center; gap:2px; user-select:none; will-change:top,left;}
    .logo-img {width:28px; height:28px; object-fit:contain; display:block;}
    .label {font-size:11px; font-weight:700; letter-spacing:0.5px; text-shadow:0 1px 5px rgba(0,0,0,0.5);}
    .bomb {width:28px; height:28px; position:relative; display:flex; justify-content:center; align-items:center;}
    .bomb-circle {width:22px; height:22px; background:#222; border-radius:50%; position:relative; box-shadow:0 0 14px rgba(255,0,0,0.7);}
    .bomb-fuse {position:absolute; top:-6px; left:50%; transform:translateX(-50%); width:4px; height:8px; background:linear-gradient(135deg,#f5e663,#ffae00); border-radius:2px;}
    .bomb-glow {position:absolute; inset:0; border-radius:50%; box-shadow:0 0 16px rgba(255,50,50,0.8);}
    #scoreboard {
      margin-top:0.75rem;
      display:flex;
      gap:1rem;
      font-size:.9rem;
      flex-wrap:wrap;
      justify-content:center;
      background:rgba(0,0,0,0.35);
      padding:6px 12px;
      border-radius:8px;
      box-shadow:0 8px 20px rgba(0,0,0,0.4);
      backdrop-filter:blur(4px);
    }
    .btn {margin-top:1rem; padding:.5rem 1rem; background:#5fa8ff; border:none; border-radius:6px; cursor:pointer; color:#fff; font-weight:600; box-shadow:0 8px 20px -2px rgba(95,168,255,0.6);}
    .btn:active {transform:scale(.97);}
    #message {
      margin-top:0.5rem;
      min-height:1.2em;
      text-align:center;
      padding:6px 14px;
      background:rgba(0,0,0,0.35);
      border-radius:6px;
      font-weight:500;
      box-shadow:0 6px 16px rgba(0,0,0,0.4);
    }
    .small {font-size:0.7rem; opacity:0.9; margin-top:4px; text-align:center;}
    #code-box {
      margin-top:0.75rem;
      background:rgba(255,255,255,0.08);
      padding:10px 16px;
      border-radius:8px;
      display:inline-flex;
      gap:8px;
      align-items:center;
      font-family:monospace;
      backdrop-filter:blur(3px);
      box-shadow:0 10px 30px -5px rgba(255,255,255,0.2);
    }
    #code {letter-spacing:1px; font-weight:700; color:#fff;}
    #copy {background:#fff;color:#0c234d;border:none;padding:6px 10px;border-radius:6px;cursor:pointer;font-size:0.8rem;font-weight:600;}
    #code-msg {margin-top:6px;font-size:0.75rem;opacity:0.9;}
  </style>
</head>
<body>
  <h1>Catch the Ethos Logo</h1>
  <div id="game">
    <div id="player"></div>
  </div>
  <div id="scoreboard">
    <div>Score: <span id="score">0</span></div>
    <div>Missed: <span id="missed">0</span>/5</div>
    <div>High Score: <span id="highScore">0</span></div>
  </div>
  <div id="message"></div>
  <div id="code-container" style="display:none;">
    <div id="code-box">
      <div>üéÅ Your Code:</div>
      <div id="code">‚Äî</div>
      <button id="copy">Copy</button>
    </div>
    <div id="code-msg">Save this code, only awarded once per session.</div>
  </div>
  <button class="btn" id="restart">Restart</button>
  <div class="small">
    Move the paddle with mouse or touch. Catch Ethos logos (with "Code") but avoid bombs. Reach 30 logo catches to earn a random code. Catching a bomb ends the game immediately.
  </div>

  <script>
    const game = document.getElementById("game");
    const player = document.getElementById("player");
    const scoreEl = document.getElementById("score");
    const missedEl = document.getElementById("missed");
    const highScoreEl = document.getElementById("highScore");
    const message = document.getElementById("message");
    const restart = document.getElementById("restart");
    const codeContainer = document.getElementById("code-container");
    const codeElem = document.getElementById("code");
    const copyBtn = document.getElementById("copy");

    const gameWidth = 320;
    let score = 0;
    let missed = 0;
    let items = [];
    let gameOver = false;
    let spawnInterval;
    let rewarded = false;

    function updatePlayer(x) {
      const rect = game.getBoundingClientRect();
      let relative = x - rect.left;
      relative = Math.max(30, Math.min(gameWidth - 30, relative));
      player.style.left = relative + "px";
    }

    game.addEventListener("mousemove", e => updatePlayer(e.clientX));
    game.addEventListener("touchmove", e => {
      if (e.touches[0]) updatePlayer(e.touches[0].clientX);
    }, {passive:true});

    function randomCode(length = 10) {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      let array = new Uint8Array(length);
      crypto.getRandomValues(array);
      let code = '';
      for (let i = 0; i < length; i++) {
        code += chars[array[i] % chars.length];
      }
      return code;
    }

    function giveRewardCode() {
      if (rewarded) return;
      rewarded = true;
      const code = randomCode(10);
      codeElem.textContent = code;
      codeContainer.style.display = "block";
      message.textContent = "üéâ Congrats! You earned a code for catching 30 logos!";
    }

    function createLogoItem() {
      const wrapper = document.createElement("div");
      wrapper.classList.add("falling");
      wrapper.dataset.type = "logo";

      const label = document.createElement("div");
      label.className = "label";
      label.textContent = "Code";

      const img = document.createElement("img");
      img.src = "https://raw.githubusercontent.com/choir94/Star/main/Ethos.png";
      img.alt = "Ethos logo";
      img.className = "logo-img";

      wrapper.appendChild(label);
      wrapper.appendChild(img);

      const x = Math.random() * (gameWidth - 28);
      wrapper.style.left = x + "px";
      wrapper.style.top = "-40px";
      game.appendChild(wrapper);
      items.push({el: wrapper, y: -40, speed: 1 + Math.random()*2, type: "logo"});
      img.onerror = () => {
        img.style.display = "none";
        const fallback = document.createElement("div");
        fallback.style.width = "16px";
        fallback.style.height = "16px";
        fallback.style.background = "#ffd700";
        fallback.style.borderRadius = "50%";
        wrapper.appendChild(fallback);
      };
    }

    function createBombItem() {
      const wrapper = document.createElement("div");
      wrapper.classList.add("falling");
      wrapper.dataset.type = "bomb";

      const bomb = document.createElement("div");
      bomb.className = "bomb";
      const glow = document.createElement("div");
      glow.className = "bomb-glow";
      const circle = document.createElement("div");
      circle.className = "bomb-circle";
      const fuse = document.createElement("div");
      fuse.className = "bomb-fuse";
      bomb.appendChild(glow);
      bomb.appendChild(circle);
      bomb.appendChild(fuse);
      wrapper.appendChild(bomb);

      const x = Math.random() * (gameWidth - 28);
      wrapper.style.left = x + "px";
      wrapper.style.top = "-40px";
      game.appendChild(wrapper);
      items.push({el: wrapper, y: -40, speed: 1 + Math.random()*2, type: "bomb"});
    }

    function spawnItem() {
      if (gameOver) return;
      if (Math.random() < 0.2) {
        createBombItem();
      } else {
        createLogoItem();
      }
    }

    function endGame(caughtBomb = false) {
      gameOver = true;
      clearInterval(spawnInterval);
      let msg = "";
      if (caughtBomb) {
        msg = "üí• You caught a bomb! Game Over!";
      } else {
        msg = "Game Over! Final score: " + score;
      }
      const prevHigh = parseInt(localStorage.getItem("highScore") || "0", 10);
      if (!caughtBomb) {
        if (score > prevHigh) {
          localStorage.setItem("highScore", score);
          msg += " üéâ New High Score!";
        } else {
          msg += " (High Score: " + prevHigh + ")";
        }
      } else {
        msg += " (High Score: " + prevHigh + ")";
      }
      message.textContent = msg;
    }

    function step() {
      if (gameOver) return;
      const playerRect = player.getBoundingClientRect();
      const gameRect = game.getBoundingClientRect();

      for (let i = items.length -1; i >=0; i--) {
        const obj = items[i];
        obj.y += obj.speed;
        obj.el.style.top = obj.y + "px";

        const itemRect = obj.el.getBoundingClientRect();

        if (
          itemRect.bottom >= playerRect.top &&
          itemRect.left + 4 < playerRect.right &&
          itemRect.right - 4 > playerRect.left
        ) {
          if (obj.type === "logo") {
            score += 1;
            scoreEl.textContent = score;
            if (score >= 30 && !rewarded) {
              giveRewardCode();
            }
          } else if (obj.type === "bomb") {
            endGame(true);
            return;
          }
          obj.el.remove();
          items.splice(i,1);
          continue;
        }

        if (obj.type === "logo" && obj.y > gameRect.height) {
          missed += 1;
          missedEl.textContent = missed;
          obj.el.remove();
          items.splice(i,1);
          if (missed >= 5) {
            endGame(false);
            return;
          }
        }

        if (obj.type === "bomb" && obj.y > gameRect.height) {
          obj.el.remove();
          items.splice(i,1);
        }
      }

      requestAnimationFrame(step);
    }

    function reset() {
      score = 0;
      missed = 0;
      items.forEach(i => i.el.remove());
      items = [];
      gameOver = false;
      rewarded = false;
      scoreEl.textContent = score;
      missedEl.textContent = missed;
      message.textContent = "";
      codeContainer.style.display = "none";
      clearInterval(spawnInterval);
      spawnInterval = setInterval(spawnItem, 800);
      highScoreEl.textContent = localStorage.getItem("highScore") || "0";
      requestAnimationFrame(step);
    }

    restart.addEventListener("click", reset);
    copyBtn.addEventListener("click", () => {
      const txt = codeElem.textContent;
      if (!txt) return;
      navigator.clipboard.writeText(txt).then(() => {
        const original = copyBtn.textContent;
        copyBtn.textContent = "Copied!";
        setTimeout(() => { copyBtn.textContent = original; }, 1000);
      });
    });

    // start game
    reset();
  </script>
</body>
</html>
